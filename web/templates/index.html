<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Monitor del Servidor - Captura la Bandera</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='imgs/BanderaFavicon.png') }}">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>游꿡 CAPTURA LA BANDERA!</h1>
            <p>Estado en tiempo real de la partida</p>
        </div>

        <div class="estado-grid">
            {% for id, info in servidor.jugadores_info.items() %}
            <div class="card" id="card-{{ id }}">
                <h3>{{ info.nombre if info.nombre else 'Jugador ' ~ id }}</h3>
                <p>ID: {{ id }}</p>
                <div class="puntos" id="puntos-{{ id }}">{{ servidor.historial_puntos.get(id, 0) }}</div>
                <p>Posici칩n: <span id="pos-{{ id }}">{{ info.posicion.x }}, {{ info.posicion.y }}</span></p>
            </div>
            {% endfor %}
        </div>

        <div class="bandera-box">
        <h2>游릴 ESTADO DE LA BANDERA 游릴</h2>
        <p id="bandera-info">
            {% if servidor.dueno_bandera %}
                {% set info_portador = servidor.jugadores_info.get(servidor.dueno_bandera) %}
                La tiene: <strong>{{ info_portador.nombre if info_portador and info_portador.nombre else 'Jugador ' ~ servidor.dueno_bandera }}</strong>
            {% else %}
                Estado: <strong>LIBRE EN EL CENTRO</strong>
            {% endif %}
        </p>
        <p>Ubicaci칩n: (<span id="bandera-pos">400, 300</span>)</p>
        </div>

        <div class="menu-acciones">
            <a href="/api/estado" class="btn">Ver JSON Crudo</a>
            <a href="/ranking" class="btn">Ver Ranking</a>
            <a href="/partidas" class="btn">Historial Partidas</a>
            <a href="/estadisticas" class="btn">Estad칤sticas Globales</a>
        </div>
    </div>
    <script src="{{ url_for('static', filename='script/refrescar.js') }}" defer></script>
</body>
</html>